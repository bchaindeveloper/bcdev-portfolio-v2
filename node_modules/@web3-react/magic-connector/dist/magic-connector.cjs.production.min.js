"use strict";var e,t=require("@web3-react/abstract-connector"),r=(e=require("tiny-invariant"))&&"object"==typeof e&&"default"in e?e.default:e;function n(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,i(e,t)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function u(e,t,r){return(u=c()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&i(o,r.prototype),o}).apply(null,arguments)}function a(e){var t="function"==typeof Map?new Map:void 0;return(a=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return u(e,arguments,o(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),i(r,e)})(e)}"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var s={1:"mainnet",3:"ropsten",4:"rinkeby",42:"kovan"},f=function(e){function t(){var t;return(t=e.call(this)||this).name=t.constructor.name,t.message="The user rejected the request.",t}return n(t,e),t}(a(Error)),l=function(e){function t(){var t;return(t=e.call(this)||this).name=t.constructor.name,t.message="The email verification failed.",t}return n(t,e),t}(a(Error)),h=function(e){function t(){var t;return(t=e.call(this)||this).name=t.constructor.name,t.message="The Magic rate limit has been reached.",t}return n(t,e),t}(a(Error)),m=function(e){function t(){var t;return(t=e.call(this)||this).name=t.constructor.name,t.message="The Magic link has expired.",t}return n(t,e),t}(a(Error)),p=function(e){function t(t){var n,o=t.apiKey,i=t.chainId,c=t.email;return Object.keys(s).includes(i.toString())||r(!1),c&&c.includes("@")||r(!1),(n=e.call(this,{supportedChainIds:[i]})||this).apiKey=o,n.chainId=i,n.email=c,n}n(t,e);var o=t.prototype;return o.activate=function(){try{var e=this;return Promise.resolve(new Promise((function(e){e(function(e){if(e&&e.__esModule)return e;var t={};return e&&Object.keys(e).forEach((function(r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})})),t.default=e,t}(require("magic-sdk")))})).then((function(e){var t;return null!=(t=null==e?void 0:e.default)?t:e}))).then((function(t){var r=t.RPCError,n=t.RPCErrorCode;return e.magic||(e.magic=new(0,t.Magic)(e.apiKey,{network:s[e.chainId]})),Promise.resolve(e.magic.user.isLoggedIn()).then((function(t){function o(o){function i(){function o(t){var r=e.magic.rpcProvider;return Promise.resolve(r.enable().then((function(e){return e[0]}))).then((function(t){return{provider:r,chainId:e.chainId,account:t}}))}var i=function(){if(!t)return function(t,r){try{var n=Promise.resolve(e.magic.auth.loginWithMagicLink({email:e.email})).then((function(){}))}catch(e){return r(e)}return n&&n.then?n.then(void 0,r):n}(0,(function(e){if(!(e instanceof r))throw e;if(e.code===n.MagicLinkFailedVerification)throw new l;if(e.code===n.MagicLinkExpired)throw new m;if(e.code===n.MagicLinkRateLimited)throw new h;if(-32603===e.code)throw new f}))}();return i&&i.then?i.then(o):o()}var c=t?o.email:o,u=function(){if(t&&c!==e.email)return Promise.resolve(e.magic.user.logout()).then((function(){}))}();return u&&u.then?u.then(i):i()}return t?Promise.resolve(e.magic.user.getMetadata()).then(o):o(null)}))}))}catch(e){return Promise.reject(e)}},o.getProvider=function(){try{return Promise.resolve(this.magic.rpcProvider)}catch(e){return Promise.reject(e)}},o.getChainId=function(){try{return Promise.resolve(this.chainId)}catch(e){return Promise.reject(e)}},o.getAccount=function(){try{return Promise.resolve(this.magic.rpcProvider.send("eth_accounts").then((function(e){return e[0]})))}catch(e){return Promise.reject(e)}},o.deactivate=function(){},o.close=function(){try{var e=this;return Promise.resolve(e.magic.user.logout()).then((function(){e.emitDeactivate()}))}catch(e){return Promise.reject(e)}},t}(t.AbstractConnector);exports.FailedVerificationError=l,exports.MagicConnector=p,exports.MagicLinkExpiredError=m,exports.MagicLinkRateLimitError=h,exports.UserRejectedRequestError=f;
//# sourceMappingURL=magic-connector.cjs.production.min.js.map
